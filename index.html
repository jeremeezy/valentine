<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Valentine ‚ù§Ô∏è</title>

  <style>
    body {
      height: 100vh;
      margin: 0;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      background: linear-gradient(135deg, #ff9a9e, #fad0c4);
      padding: 24px 16px;
      box-sizing: border-box;
      user-select: none;
      -webkit-user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    h1 {
      margin: 0 0 24px;
      color: #fff;
      text-align: center;
      line-height: 1.15;
      font-size: 28px;
    }

    .buttons {
      position: relative;
      width: min(360px, 92vw);
      height: 240px;
    }

    button {
      padding: 16px 28px;
      font-size: 18px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: transform 0.18s ease;
      position: absolute;
      box-shadow: 0 10px 26px rgba(0,0,0,0.18);
      touch-action: manipulation; /* √©vite double-tap zoom */
    }

    #yes {
      background-color: #2ecc71;
      color: white;
      left: 16px;
      top: 120px;
    }

    #no {
      background-color: #e74c3c;
      color: white;
      right: 16px;
      top: 120px;
    }

    /* Confettis canvas */
    #confettiCanvas {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 10;
    }

    /* Overlay final */
    #overlay {
      position: fixed;
      inset: 0;
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      background: rgba(0,0,0,0.28);
      z-index: 20;
      text-align: center;
      padding: 24px 16px;
      color: #fff;
    }

    #overlay h2 {
      margin: 0 0 10px;
      font-size: 34px;
    }

    #overlay p {
      margin: 0 0 16px;
      font-size: 18px;
      opacity: 0.95;
    }

    #overlay img {
      width: min(320px, 85vw);
      border-radius: 14px;
      box-shadow: 0 12px 34px rgba(0,0,0,0.28);
      margin-bottom: 18px;
    }

    #restart {
      background: rgba(255,255,255,0.92);
      color: #111;
      padding: 12px 18px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }
  </style>
</head>

<body>
  <canvas id="confettiCanvas"></canvas>

  <h1>Veux-tu √™tre ma Valentine ? üíò</h1>

  <div class="buttons" id="arena">
    <button id="yes">Oui üíï</button>
    <button id="no">Non üò¢</button>
  </div>

  <div id="overlay">
    <h2>Yessss üíñ</h2>
    <p>Je savais que tu allais dire oui üòè</p>
    <img src="confetti.gif" alt="Confettis" />
    <button id="restart">Recommencer</button>
  </div>

  <script>
    const arena = document.getElementById("arena");
    const noButton = document.getElementById("no");
    const yesButton = document.getElementById("yes");
    const overlay = document.getElementById("overlay");
    const restart = document.getElementById("restart");

    // OUI grossit √† chaque fuite
    let yesScale = 1;

    // Position initiale NON (pour reset)
    const initialNo = { left: null, top: null };

    // Helper: clamp
    const clamp = (v, min, max) => Math.max(min, Math.min(max, v));

    function moveNoRandomly(avoidPoint = null) {
      // On force le bouton √† utiliser left/top (sinon right:16px bloque)
      if (getComputedStyle(noButton).right !== "auto") {
        const rect = noButton.getBoundingClientRect();
        const arenaRect = arena.getBoundingClientRect();
        noButton.style.left = (rect.left - arenaRect.left) + "px";
        noButton.style.top = (rect.top - arenaRect.top) + "px";
        noButton.style.right = "auto";
      }

      const arenaRect = arena.getBoundingClientRect();
      const btnRect = noButton.getBoundingClientRect();

      const maxX = arenaRect.width - btnRect.width;
      const maxY = arenaRect.height - btnRect.height;

      // On essaie quelques fois de trouver une position loin du doigt
      let x, y;
      for (let i = 0; i < 10; i++) {
        x = Math.random() * maxX;
        y = Math.random() * maxY;

        if (!avoidPoint) break;

        const bx = arenaRect.left + x + btnRect.width / 2;
        const by = arenaRect.top + y + btnRect.height / 2;

        const dx = bx - avoidPoint.x;
        const dy = by - avoidPoint.y;
        const dist = Math.sqrt(dx*dx + dy*dy);

        // veut √™tre au moins √† ~120px du doigt
        if (dist > 120) break;
      }

      x = clamp(x, 0, maxX);
      y = clamp(y, 0, maxY);

      noButton.style.left = x + "px";
      noButton.style.top = y + "px";

      // Grossir le OUI
      yesScale += 0.18;
      yesButton.style.transform = `scale(${yesScale})`;
    }

    // Mobile: quand tu ESSAYES de toucher NON -> il fuit
    noButton.addEventListener("touchstart", (e) => {
      e.preventDefault(); // emp√™che le "click" fant√¥me
      const t = e.touches[0];
      moveNoRandomly({ x: t.clientX, y: t.clientY });
    }, { passive: false });

    // Desktop fallback: si ouvert sur ordi
    noButton.addEventListener("mouseenter", () => moveNoRandomly());

    // BONUS mobile: si tu touches la zone autour, NON peut aussi fuir
    // (√ßa donne l'impression qu'il "sent" ton doigt)
    arena.addEventListener("touchmove", (e) => {
      const t = e.touches[0];
      const noRect = noButton.getBoundingClientRect();

      // si le doigt est proche du bouton NON (zone de 70px), il fuit
      const pad = 70;
      const near =
        t.clientX > noRect.left - pad &&
        t.clientX < noRect.right + pad &&
        t.clientY > noRect.top - pad &&
        t.clientY < noRect.bottom + pad;

      if (near) {
        moveNoRandomly({ x: t.clientX, y: t.clientY });
      }
    }, { passive: true });

    // Confettis canvas
    const canvas = document.getElementById("confettiCanvas");
    const ctx = canvas.getContext("2d");

    function resize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resize);
    resize();

    let confettis = [];
    let animId = null;

    function createConfettiBurst(count = 260) {
      confettis = [];
      for (let i = 0; i < count; i++) {
        confettis.push({
          x: Math.random() * canvas.width,
          y: -20 - Math.random() * canvas.height * 0.3,
          vx: (Math.random() - 0.5) * 7,
          vy: 3 + Math.random() * 7,
          size: 6 + Math.random() * 7,
          rot: Math.random() * Math.PI,
          vr: (Math.random() - 0.5) * 0.25,
          color: `hsl(${Math.floor(Math.random() * 360)}, 90%, 60%)`,
          life: 240 + Math.random() * 120
        });
      }
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      confettis.forEach(p => {
        p.x += p.vx;
        p.y += p.vy;
        p.rot += p.vr;
        p.vy += 0.03;
        p.life--;

        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot);
        ctx.fillStyle = p.color;
        ctx.fillRect(-p.size / 2, -p.size / 2, p.size, p.size * 0.6);
        ctx.restore();
      });

      confettis = confettis.filter(p => p.life > 0 && p.y < canvas.height + 60);

      if (confettis.length > 0) {
        animId = requestAnimationFrame(draw);
      } else {
        cancelAnimationFrame(animId);
        animId = null;
      }
    }

    function launchConfetti() {
      createConfettiBurst(280);
      if (!animId) draw();
    }

    // Clic OUI
    yesButton.addEventListener("click", () => {
      overlay.style.display = "flex";
      launchConfetti();
    });

    restart.addEventListener("click", () => {
      overlay.style.display = "none";
      yesScale = 1;
      yesButton.style.transform = "scale(1)";

      // reset NON
      noButton.style.right = "16px";
      noButton.style.left = "";
      noButton.style.top = "120px";
    });
  </script>
</body>
</html>

